{{did-insert this.handleVisibilityChanges}}
{{did-update this.handleVisibilityChanges @open}}

{{!
  ember-on-helper do not support FastBoot yet. This guard can be removed as
  soon as ember-on-helper guards for FastBoot itself. It is tracked in this
  GitHub issue: https://github.com/buschtoens/ember-on-helper/issues/3
}}
{{#unless this.isFastBoot}}
  {{on-window "resize" this.adjustDialog}}
{{/unless}}

{{#if this.isInDom}}
  {{#let (component (bs-default @dialogComponent (component "bs-modal/dialog"))
    onClose=this.close
    fade=this._fade
    showModal=this.isShowModal
    keyboard=this.keyboard
    size=@size
    backdropClose=this.backdropClose
    inDom=this.isInDom
    paddingLeft=this.paddingLeft
    paddingRight=this.paddingRight
    centered=(bs-eq this.position "center")
    scrollable=this.scrollable
  ) as |Dialog|}}
    {{#if this._renderInPlace}}
      <Dialog
        class={{@class}}
        id={{this.modalId}}
        ...attributes
      >
        {{yield
          (hash
            header=(component (bs-default @headerComponent (component "bs-modal/header")) onClose=this.close)
            body=(bs-default @bodyComponent (component "bs-modal/body"))
            footer=(component (bs-default @footerComponent (component "bs-modal/footer")) onClose=this.close onSubmit=this.doSubmit)
            close=this.close
            submit=this.doSubmit
          )
        }}
      </Dialog>
      <div>
        {{#if this.isBackdropShown}}
          <div class="modal-backdrop {{if this._fade "fade"}} {{if this.isShowModal (if (macroCondition (macroGetOwnConfig "isNotBS3")) "show" "in")}}" id={{this.backdropId}}></div>
        {{/if}}
      </div>
    {{else}}
      {{#in-element this.destinationElement insertBefore=null}}
        <Dialog
          class={{@class}}
          id={{this.modalId}}
          ...attributes
        >
          {{yield
            (hash
              header=(component (bs-default @headerComponent (component "bs-modal/header")) onClose=this.close)
              body=(bs-default @bodyComponent (component "bs-modal/body"))
              footer=(component (bs-default @footerComponent (component "bs-modal/footer")) onClose=this.close onSubmit=this.doSubmit)
              close=this.close
              submit=this.doSubmit
            )
          }}
        </Dialog>
        <div>
          {{#if this.isBackdropShown}}
            <div class="modal-backdrop {{if this._fade "fade"}} {{if this.isShowModal (if (macroCondition (macroGetOwnConfig "isNotBS3")) "show" "in")}}" id={{this.backdropId}}></div>
          {{/if}}
        </div>
      {{/in-element}}
    {{/if}}
  {{/let}}
{{/if}}
